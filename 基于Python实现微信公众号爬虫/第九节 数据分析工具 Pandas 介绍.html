<html>
<head>
  <title>数据分析工具 Pandas 介绍</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600553 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="22809"/>
<h1>数据分析工具 Pandas 介绍</h1>

<div><span>
  <div>
<div><br/></div><div style="font-size: 16px; display:block; min-width: 100%; position: relative;"> <div style="font-family:-apple-system, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif;text-size-adjust:100%;font-size:12px;text-rendering:optimizeLegibility;color:rgb(51, 51, 51);background-color:rgb(244, 245, 245);word-break:break-word;"><div style="font-size:12px;line-height:normal;word-break:break-word;"><div style="overflow-x:initial;"><div style="overflow:hidden;"><div><div style="transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1) 0s;"><div><div style="box-sizing:border-box;background-color:rgb(230, 231, 233);"><div><div><div style="box-shadow:rgba(0, 0, 0, 0.15) 1px 1px 8px;background-color:rgb(255, 255, 255);border-radius:2px;box-sizing:border-box;"><div style="word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;"><h1 style="font-size:30px;margin:1.3rem 0px;line-height:1.5;color:rgb(51, 51, 51);margin-top:35px;margin-bottom:5px;padding-bottom:5px;">数据分析工具 Pandas 介绍</h1>
<h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-bottom:10px;padding-bottom:0px;font-size:18px;margin-top:15px;">什么是Pandas</h3>
<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">Pandas 是做数据分析的基础包，提供了灵活的数据结构和其它方便进行向量化计算的工具和函数, 使得 Python 也能够像 R 语言一样方便地用于数据分析和处理。在 Pandas 中有两种常见数据结构，分别是 Series 和 DataFrame。</p>
<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">Series 是一种增强型的一维数组，与 Python 中的列表相似，由 index（索引）和 values（值）组成， Series 中的值是相同的数据类型。</p>
<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;"></p><div style="display:block;margin:22px auto;text-align:center;"><img src="数据分析工具 Pandas 介绍_files/1" type="image/webp" data-filename="1" height="265" style="background-color:transparent;width:auto;border-style:none;height:auto;max-height:none;visibility:visible;background-position:50% center;background-repeat:no-repeat;background-image:none;margin:0px;cursor:zoom-in;max-width:100%;" width="301"/><div style="display:block;text-align:center;font-size:12px;line-height:1.6;color:rgb(144, 144, 144);margin-top:2px;"></div></div>
而 DataFrame 是增强型的二维数组，就像 Excel 中的表格，有行标签和列表索引，这种数据结构在Pandas 中最为常用。<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;"></p>
<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;"></p><div style="display:block;margin:22px auto;text-align:center;"><img src="数据分析工具 Pandas 介绍_files/1 [1]" type="image/webp" data-filename="1" height="339" style="background-color:transparent;width:auto;border-style:none;height:auto;max-height:none;visibility:visible;background-position:50% center;background-repeat:no-repeat;background-image:none;margin:0px;cursor:zoom-in;max-width:100%;" width="429"/><div style="display:block;text-align:center;font-size:12px;line-height:1.6;color:rgb(144, 144, 144);margin-top:2px;"></div></div><p style="line-height:inherit;margin-top:22px;margin-bottom:22px;"></p>
<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">在做数据分析前，我们会约定俗成地引入 Numpy 、Pandas、Matplotlib 三个工具包，并使用其简称 np，pd，plt。numpy 是科学计算基础包，pandas 依赖于 numpy，而 matplitlib 是绘图工具。(以下代码均在 IPython 中完成，如果你已经成功安装了 Anoconda，那么可以直接运行 <code style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:0.87em;padding:0.065em 0.4em;word-break:break-word;color:rgb(255, 80, 44);background-color:rgb(255, 245, 245);border-radius:2px;overflow-x:auto;">ipython</code> 命令进入)</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="bash" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;"></span>import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">Series</h3>
<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">用列表可创建Series对象</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">30</span>]: s = pd.Series([<span style="color:rgb(221, 17, 68);">'a'</span>,<span style="color:rgb(221, 17, 68);">'b'</span>,<span style="color:rgb(221, 17, 68);">'c'</span>])

In [<span style="color:teal;">31</span>]: s
Out[<span style="color:teal;">31</span>]:
<span style="color:teal;">0</span>    a
<span style="color:teal;">1</span>    b
<span style="color:teal;">2</span>    c
dtype: object
</code></pre><p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">Series 和列表一样每个元素有对应的索引，默认是0到n（n是列表的长度），也手动指定索引名字</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">42</span>]: s = pd.Series([<span style="color:rgb(221, 17, 68);">'a'</span>,<span style="color:rgb(221, 17, 68);">'b'</span>,<span style="color:rgb(221, 17, 68);">'c'</span>], index=[<span style="color:rgb(221, 17, 68);">'x'</span>,<span style="color:rgb(221, 17, 68);">'y'</span>,<span style="color:rgb(221, 17, 68);">'z'</span>])

In [<span style="color:teal;">43</span>]: s
Out[<span style="color:teal;">43</span>]:
x    a
y    b
z    c
dtype: object
</code></pre><p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">可以通过索引获取元素</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">50</span>]: s[<span style="color:rgb(221, 17, 68);">'x'</span>]
Out[<span style="color:teal;">50</span>]: <span style="color:rgb(221, 17, 68);">'a'</span>
</code></pre><p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">像列表一样，支持切片</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">51</span>]: s[:<span style="color:teal;">2</span>]
Out[<span style="color:teal;">51</span>]:
x    a
y    b
dtype: object

</code></pre><p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">可以使用字典创建Series（Series也可以看做是一个特殊的字典对象，都是索引到值的映射）</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">272</span>]: s2 = pd.Series({<span style="color:teal;">1</span>:<span style="color:rgb(221, 17, 68);">&quot;a&quot;</span>,<span style="color:teal;">2</span>:<span style="color:rgb(221, 17, 68);">&quot;b&quot;</span>,<span style="color:teal;">3</span>:<span style="color:rgb(221, 17, 68);">&quot;c&quot;</span>})

In [<span style="color:teal;">273</span>]: s2
Out[<span style="color:teal;">273</span>]:
<span style="color:teal;">1</span>    a
<span style="color:teal;">2</span>    b
<span style="color:teal;">3</span>    c
dtype: object
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">DataFrame</h3>
<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">有很多方法可以创建 DataFrame 对象，可以通过用相等长度的列表组成的字典对象来构建 DataFrame</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">52</span>]: data = {<span style="color:rgb(221, 17, 68);">'state'</span>: [<span style="color:rgb(221, 17, 68);">'Ohio'</span>, <span style="color:rgb(221, 17, 68);">'Ohio'</span>, <span style="color:rgb(221, 17, 68);">'Ohio'</span>, <span style="color:rgb(221, 17, 68);">'Nevada'</span>, <span style="color:rgb(221, 17, 68);">'Nevada'</span>],
    ...:         <span style="color:rgb(221, 17, 68);">'year'</span>: [<span style="color:teal;">2000</span>, <span style="color:teal;">2001</span>, <span style="color:teal;">2002</span>, <span style="color:teal;">2001</span>, <span style="color:teal;">2002</span>],
    ...:         <span style="color:rgb(221, 17, 68);">'pop'</span>: [<span style="color:teal;">1.5</span>, <span style="color:teal;">1.7</span>, <span style="color:teal;">3.6</span>, <span style="color:teal;">2.4</span>, <span style="color:teal;">2.9</span>]}
    ...:


In [<span style="color:teal;">54</span>]: df = pd.DataFrame(data)

In [<span style="color:teal;">55</span>]: df
Out[<span style="color:teal;">55</span>]:
   pop   state  year
<span style="color:teal;">0</span>  <span style="color:teal;">1.5</span>    Ohio  <span style="color:teal;">2000</span>
<span style="color:teal;">1</span>  <span style="color:teal;">1.7</span>    Ohio  <span style="color:teal;">2001</span>
<span style="color:teal;">2</span>  <span style="color:teal;">3.6</span>    Ohio  <span style="color:teal;">2002</span>
<span style="color:teal;">3</span>  <span style="color:teal;">2.4</span>  Nevada  <span style="color:teal;">2001</span>
<span style="color:teal;">4</span>  <span style="color:teal;">2.9</span>  Nevada  <span style="color:teal;">2002</span>
</code></pre><p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">也可以通过 Numpy 的二维数组来构建 DataFrame</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span><span style="color:rgb(153, 153, 136);"># 随机生成6行4列的二维数组</span>
In [<span style="color:teal;">58</span>]:  df = pd.DataFrame(np.random.randn(<span style="color:teal;">6</span>,<span style="color:teal;">4</span>))

In [<span style="color:teal;">59</span>]: df
Out[<span style="color:teal;">59</span>]:
          <span style="color:teal;">0</span>         <span style="color:teal;">1</span>         <span style="color:teal;">2</span>         <span style="color:teal;">3</span>
<span style="color:teal;">0</span>  <span style="color:teal;">0.447964</span> <span style="color:teal;">-0.486327</span> <span style="color:teal;">-1.593023</span> <span style="color:teal;">-0.314114</span>
<span style="color:teal;">1</span>  <span style="color:teal;">1.004132</span> <span style="color:teal;">-0.058186</span>  <span style="color:teal;">0.076479</span>  <span style="color:teal;">0.076231</span>
<span style="color:teal;">2</span>  <span style="color:teal;">0.445284</span>  <span style="color:teal;">0.592718</span>  <span style="color:teal;">0.214101</span> <span style="color:teal;">-0.322876</span>
<span style="color:teal;">3</span> <span style="color:teal;">-0.006924</span> <span style="color:teal;">-0.738673</span>  <span style="color:teal;">0.277461</span>  <span style="color:teal;">0.448946</span>
<span style="color:teal;">4</span>  <span style="color:teal;">0.100352</span>  <span style="color:teal;">1.416282</span>  <span style="color:teal;">0.353527</span>  <span style="color:teal;">0.640276</span>
<span style="color:teal;">5</span>  <span style="color:teal;">0.804352</span> <span style="color:teal;">-0.374634</span>  <span style="color:teal;">0.734836</span>  <span style="color:teal;">0.247061</span>
</code></pre><p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">还可以从 csv 文件、数据库中获取，现在先来熟悉 DataFrame 中常用属性和操作方法，以便后续能够灵活运用 Pandas。</p>
<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">DataFrame 既有行索引（index）也有列索引（columns），构建 DataFrame 时可以指定每行的名字和每列的名字，例如下面的 DataFrame 用时间作为行索引，字母 A、B、C、D 作为列索引。</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">61</span>]: dates = pd.date_range(<span style="color:rgb(221, 17, 68);">'20130101'</span>,periods=<span style="color:teal;">6</span>)

In [<span style="color:teal;">62</span>]: dates
Out[<span style="color:teal;">62</span>]:
DatetimeIndex([<span style="color:rgb(221, 17, 68);">'2013-01-01'</span>, <span style="color:rgb(221, 17, 68);">'2013-01-02'</span>, <span style="color:rgb(221, 17, 68);">'2013-01-03'</span>, <span style="color:rgb(221, 17, 68);">'2013-01-04'</span>,
               <span style="color:rgb(221, 17, 68);">'2013-01-05'</span>, <span style="color:rgb(221, 17, 68);">'2013-01-06'</span>],
              dtype=<span style="color:rgb(221, 17, 68);">'datetime64[ns]'</span>, freq=<span style="color:rgb(221, 17, 68);">'D'</span>)

In [<span style="color:teal;">63</span>]: df = pd.DataFrame(np.random.randn(<span style="color:teal;">6</span>,<span style="color:teal;">4</span>),index=dates,columns=list(<span style="color:rgb(221, 17, 68);">'ABCD'</span>))

In [<span style="color:teal;">64</span>]: df
Out[<span style="color:teal;">64</span>]:
                   A         B         C         D
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>  <span style="color:teal;">0.513286</span> <span style="color:teal;">-1.475824</span>  <span style="color:teal;">1.939876</span> <span style="color:teal;">-0.163942</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>  <span style="color:teal;">0.510746</span>  <span style="color:teal;">1.284767</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>  <span style="color:teal;">1.830259</span> <span style="color:teal;">-0.719290</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>  <span style="color:teal;">0.654418</span> <span style="color:teal;">-0.994241</span>  <span style="color:teal;">0.162705</span>  <span style="color:teal;">2.816623</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span>  <span style="color:teal;">1.540274</span> <span style="color:teal;">-0.227124</span>  <span style="color:teal;">1.843401</span> <span style="color:teal;">-2.977880</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>  <span style="color:teal;">0.888156</span>  <span style="color:teal;">1.932291</span>  <span style="color:teal;">0.998568</span>  <span style="color:teal;">0.143846</span>
</code></pre><p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">DataFrame 其实就是由3部分组成的，分别是 index、columns、values</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">79</span>]: df.columns
Out[<span style="color:teal;">79</span>]: Index([<span style="color:rgb(221, 17, 68);">'A'</span>, <span style="color:rgb(221, 17, 68);">'B'</span>, <span style="color:rgb(221, 17, 68);">'C'</span>, <span style="color:rgb(221, 17, 68);">'D'</span>], dtype=<span style="color:rgb(221, 17, 68);">'object'</span>)

In [<span style="color:teal;">80</span>]: df.index
Out[<span style="color:teal;">80</span>]:
DatetimeIndex([<span style="color:rgb(221, 17, 68);">'2013-01-01'</span>, <span style="color:rgb(221, 17, 68);">'2013-01-02'</span>, <span style="color:rgb(221, 17, 68);">'2013-01-03'</span>, <span style="color:rgb(221, 17, 68);">'2013-01-04'</span>,
               <span style="color:rgb(221, 17, 68);">'2013-01-05'</span>, <span style="color:rgb(221, 17, 68);">'2013-01-06'</span>],
              dtype=<span style="color:rgb(221, 17, 68);">'datetime64[ns]'</span>, freq=<span style="color:rgb(221, 17, 68);">'D'</span>)

In [<span style="color:teal;">81</span>]: df.values
Out[<span style="color:teal;">81</span>]:
array([[ <span style="color:teal;">0.51328621</span>, <span style="color:teal;">-1.475824</span>  ,  <span style="color:teal;">1.93987575</span>, <span style="color:teal;">-0.16394233</span>],
       [<span style="color:teal;">-0.51829132</span>,  <span style="color:teal;">1.34522999</span>,  <span style="color:teal;">0.51074601</span>,  <span style="color:teal;">1.2847668</span> ],
       [<span style="color:teal;">-0.43486491</span>, <span style="color:teal;">-0.46422712</span>,  <span style="color:teal;">1.83025914</span>, <span style="color:teal;">-0.71928957</span>],
       [ <span style="color:teal;">0.65441841</span>, <span style="color:teal;">-0.99424111</span>,  <span style="color:teal;">0.16270488</span>,  <span style="color:teal;">2.81662335</span>],
       [ <span style="color:teal;">1.54027403</span>, <span style="color:teal;">-0.22712424</span>,  <span style="color:teal;">1.84340078</span>, <span style="color:teal;">-2.97787999</span>],
       [ <span style="color:teal;">0.88815632</span>,  <span style="color:teal;">1.93229088</span>,  <span style="color:teal;">0.99856774</span>,  <span style="color:teal;">0.14384553</span>]])
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">head()</h3>
<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">head() 返回 DataFrame 的头部数据（默认返回表格中的前5行数据），也可以指定返回的行数</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">70</span>]: df.head(<span style="color:teal;">3</span>)
Out[<span style="color:teal;">70</span>]:
                   A         B         C         D
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>  <span style="color:teal;">0.513286</span> <span style="color:teal;">-1.475824</span>  <span style="color:teal;">1.939876</span> <span style="color:teal;">-0.163942</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>  <span style="color:teal;">0.510746</span>  <span style="color:teal;">1.284767</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>  <span style="color:teal;">1.830259</span> <span style="color:teal;">-0.719290</span>
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">tail()</h3>
<p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">tail() 返回 DataFrame 的尾部数据（默认返回表格中的最后5行数据）</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">72</span>]: df.tail()
Out[<span style="color:teal;">72</span>]:
                   A         B         C         D
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>  <span style="color:teal;">0.510746</span>  <span style="color:teal;">1.284767</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>  <span style="color:teal;">1.830259</span> <span style="color:teal;">-0.719290</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>  <span style="color:teal;">0.654418</span> <span style="color:teal;">-0.994241</span>  <span style="color:teal;">0.162705</span>  <span style="color:teal;">2.816623</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span>  <span style="color:teal;">1.540274</span> <span style="color:teal;">-0.227124</span>  <span style="color:teal;">1.843401</span> <span style="color:teal;">-2.977880</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>  <span style="color:teal;">0.888156</span>  <span style="color:teal;">1.932291</span>  <span style="color:teal;">0.998568</span>  <span style="color:teal;">0.143846</span>
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">按索引排序</h3>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span><span style="color:rgb(153, 153, 136);"># 按照列索引的降序排列：D-&gt;C-&gt;B-&gt;A </span>
In [<span style="color:teal;">96</span>]: df.sort_index(axis=<span style="color:teal;">1</span>, ascending=<span style="color:rgb(51, 51, 51);font-weight:700;">False</span>)
Out[<span style="color:teal;">96</span>]:
                   D         C         B         A
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span> <span style="color:teal;">-0.163942</span>  <span style="color:teal;">1.939876</span> <span style="color:teal;">-1.475824</span>  <span style="color:teal;">0.513286</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span>  <span style="color:teal;">1.284767</span>  <span style="color:teal;">0.510746</span>  <span style="color:teal;">1.345230</span> <span style="color:teal;">-0.518291</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.719290</span>  <span style="color:teal;">1.830259</span> <span style="color:teal;">-0.464227</span> <span style="color:teal;">-0.434865</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>  <span style="color:teal;">2.816623</span>  <span style="color:teal;">0.162705</span> <span style="color:teal;">-0.994241</span>  <span style="color:teal;">0.654418</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span> <span style="color:teal;">-2.977880</span>  <span style="color:teal;">1.843401</span> <span style="color:teal;">-0.227124</span>  <span style="color:teal;">1.540274</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>  <span style="color:teal;">0.143846</span>  <span style="color:teal;">0.998568</span>  <span style="color:teal;">1.932291</span>  <span style="color:teal;">0.888156</span>

<span style="color:rgb(153, 153, 136);"># 按照行索引的降序排列：2012-01-06-&gt;...-&gt;2013-01-01</span>
In [<span style="color:teal;">97</span>]: df.sort_index(axis=<span style="color:teal;">0</span>, ascending=<span style="color:rgb(51, 51, 51);font-weight:700;">False</span>)
Out[<span style="color:teal;">97</span>]:
                   A         B         C         D
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>  <span style="color:teal;">0.888156</span>  <span style="color:teal;">1.932291</span>  <span style="color:teal;">0.998568</span>  <span style="color:teal;">0.143846</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span>  <span style="color:teal;">1.540274</span> <span style="color:teal;">-0.227124</span>  <span style="color:teal;">1.843401</span> <span style="color:teal;">-2.977880</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>  <span style="color:teal;">0.654418</span> <span style="color:teal;">-0.994241</span>  <span style="color:teal;">0.162705</span>  <span style="color:teal;">2.816623</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>  <span style="color:teal;">1.830259</span> <span style="color:teal;">-0.719290</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>  <span style="color:teal;">0.510746</span>  <span style="color:teal;">1.284767</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>  <span style="color:teal;">0.513286</span> <span style="color:teal;">-1.475824</span>  <span style="color:teal;">1.939876</span> <span style="color:teal;">-0.163942</span>
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">按值排序</h3>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span><span style="color:rgb(153, 153, 136);"># 根据B列的值的升序排列</span>
In [<span style="color:teal;">99</span>]: df.sort_values(by=<span style="color:rgb(221, 17, 68);">'B'</span>)
Out[<span style="color:teal;">99</span>]:
                   A         B         C         D
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>  <span style="color:teal;">0.513286</span> <span style="color:teal;">-1.475824</span>  <span style="color:teal;">1.939876</span> <span style="color:teal;">-0.163942</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>  <span style="color:teal;">0.654418</span> <span style="color:teal;">-0.994241</span>  <span style="color:teal;">0.162705</span>  <span style="color:teal;">2.816623</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>  <span style="color:teal;">1.830259</span> <span style="color:teal;">-0.719290</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span>  <span style="color:teal;">1.540274</span> <span style="color:teal;">-0.227124</span>  <span style="color:teal;">1.843401</span> <span style="color:teal;">-2.977880</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>  <span style="color:teal;">0.510746</span>  <span style="color:teal;">1.284767</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>  <span style="color:teal;">0.888156</span>  <span style="color:teal;">1.932291</span>  <span style="color:teal;">0.998568</span>  <span style="color:teal;">0.143846</span>

<span style="color:rgb(153, 153, 136);"># 先按A的升序排，再按B的降序排</span>
In [<span style="color:teal;">161</span>]: df.sort_values(by=[<span style="color:rgb(221, 17, 68);">'A'</span>,<span style="color:rgb(221, 17, 68);">'B'</span>], ascending=[<span style="color:rgb(51, 51, 51);font-weight:700;">True</span>, <span style="color:rgb(51, 51, 51);font-weight:700;">False</span>])
Out[<span style="color:teal;">161</span>]:
                   A         B         C         D
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>  <span style="color:teal;">0.510746</span>  <span style="color:teal;">1.284767</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>  <span style="color:teal;">1.830259</span> <span style="color:teal;">-0.719290</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>  <span style="color:teal;">0.513286</span> <span style="color:teal;">-1.475824</span>  <span style="color:teal;">1.939876</span> <span style="color:teal;">-0.163942</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>  <span style="color:teal;">0.654418</span> <span style="color:teal;">-0.994241</span>  <span style="color:teal;">0.162705</span>  <span style="color:teal;">2.816623</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>  <span style="color:teal;">0.888156</span>  <span style="color:teal;">1.932291</span>  <span style="color:teal;">0.998568</span>  <span style="color:teal;">0.143846</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span>  <span style="color:teal;">1.540274</span> <span style="color:teal;">-0.227124</span>  <span style="color:teal;">1.843401</span> <span style="color:teal;">-2.977880</span>
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">选择数据</h3>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span><span style="color:rgb(153, 153, 136);"># 选择一列，返回 Series 对象</span>
In [<span style="color:teal;">100</span>]: df[<span style="color:rgb(221, 17, 68);">'A'</span>]
Out[<span style="color:teal;">100</span>]:
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>    <span style="color:teal;">0.513286</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span>   <span style="color:teal;">-0.518291</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span>   <span style="color:teal;">-0.434865</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>    <span style="color:teal;">0.654418</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span>    <span style="color:teal;">1.540274</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>    <span style="color:teal;">0.888156</span>
Freq: D, Name: A, dtype: float64

<span style="color:rgb(153, 153, 136);"># 选择多列，返回 DataFrame 对象</span>
In [<span style="color:teal;">102</span>]: df[[<span style="color:rgb(221, 17, 68);">'A'</span>,<span style="color:rgb(221, 17, 68);">'B'</span>]]
Out[<span style="color:teal;">102</span>]:
                   A         B
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>  <span style="color:teal;">0.513286</span> <span style="color:teal;">-1.475824</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>  <span style="color:teal;">0.654418</span> <span style="color:teal;">-0.994241</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span>  <span style="color:teal;">1.540274</span> <span style="color:teal;">-0.227124</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>  <span style="color:teal;">0.888156</span>  <span style="color:teal;">1.932291</span>
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">切片操作</h3>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">101</span>]: df[<span style="color:teal;">0</span>:<span style="color:teal;">3</span>]
Out[<span style="color:teal;">101</span>]:
                   A         B         C         D
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>  <span style="color:teal;">0.513286</span> <span style="color:teal;">-1.475824</span>  <span style="color:teal;">1.939876</span> <span style="color:teal;">-0.163942</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>  <span style="color:teal;">0.510746</span>  <span style="color:teal;">1.284767</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>  <span style="color:teal;">1.830259</span> <span style="color:teal;">-0.719290</span>
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">通过loc、.iloc 高效获取数据</h3>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span><span style="color:rgb(153, 153, 136);"># 通过行索引切片获取指定列数据</span>
In [<span style="color:teal;">145</span>]: df.loc[<span style="color:rgb(221, 17, 68);">&quot;2013-01-01&quot;</span>:<span style="color:rgb(221, 17, 68);">&quot;2013-01-03&quot;</span>, [<span style="color:rgb(221, 17, 68);">'A'</span>,<span style="color:rgb(221, 17, 68);">'B'</span>]]
Out[<span style="color:teal;">145</span>]:
                   A         B
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>  <span style="color:teal;">0.513286</span> <span style="color:teal;">-1.475824</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>

<span style="color:rgb(153, 153, 136);"># 通过行号切片获取（1到4行，0到2列）数据</span>
In [<span style="color:teal;">149</span>]: df.iloc[<span style="color:teal;">1</span>:<span style="color:teal;">4</span>, <span style="color:teal;">0</span>:<span style="color:teal;">2</span>]
Out[<span style="color:teal;">149</span>]:
                   A         B
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>  <span style="color:teal;">0.654418</span> <span style="color:teal;">-0.994241</span>

</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">通过条件过滤数据</h3>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">104</span>]: df[df.A&gt;<span style="color:teal;">0</span>]
Out[<span style="color:teal;">104</span>]:
                   A         B         C         D
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>  <span style="color:teal;">0.513286</span> <span style="color:teal;">-1.475824</span>  <span style="color:teal;">1.939876</span> <span style="color:teal;">-0.163942</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>  <span style="color:teal;">0.654418</span> <span style="color:teal;">-0.994241</span>  <span style="color:teal;">0.162705</span>  <span style="color:teal;">2.816623</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span>  <span style="color:teal;">1.540274</span> <span style="color:teal;">-0.227124</span>  <span style="color:teal;">1.843401</span> <span style="color:teal;">-2.977880</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>  <span style="color:teal;">0.888156</span>  <span style="color:teal;">1.932291</span>  <span style="color:teal;">0.998568</span>  <span style="color:teal;">0.143846</span>
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">求和</h3>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">115</span>]: df.sum()
Out[<span style="color:teal;">115</span>]:
A    <span style="color:teal;">2.642979</span>
B    <span style="color:teal;">0.116104</span>
C    <span style="color:teal;">7.285554</span>
D    <span style="color:teal;">0.384124</span>
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">求平均值</h3>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">121</span>]: df.mean()
Out[<span style="color:teal;">121</span>]:
A    <span style="color:teal;">0.440496</span>
B    <span style="color:teal;">0.019351</span>
C    <span style="color:teal;">1.214259</span>
D    <span style="color:teal;">0.064021</span>
dtype: float64
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">求最大/小值</h3>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">157</span>]: df.max()
Out[<span style="color:teal;">157</span>]:
A    <span style="color:teal;">1.540274</span>
B    <span style="color:teal;">1.932291</span>
C    <span style="color:teal;">1.939876</span>
D    <span style="color:teal;">2.816623</span>

In [<span style="color:teal;">159</span>]: df.min()
Out[<span style="color:teal;">159</span>]:
A   <span style="color:teal;">-0.518291</span>
B   <span style="color:teal;">-1.475824</span>
C    <span style="color:teal;">0.162705</span>
D   <span style="color:teal;">-2.977880</span>
dtype: float64
</code></pre><h3 style="color:rgb(51, 51, 51);line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:0px;font-size:18px;">分组 groupby</h3>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span>In [<span style="color:teal;">252</span>]: df.groupby(<span style="color:rgb(221, 17, 68);">'A'</span>).size()
Out[<span style="color:teal;">252</span>]:
A
<span style="color:teal;">-0.518291</span>    <span style="color:teal;">1</span>
<span style="color:teal;">-0.434865</span>    <span style="color:teal;">1</span>
 <span style="color:teal;">0.513286</span>    <span style="color:teal;">1</span>
 <span style="color:teal;">0.654418</span>    <span style="color:teal;">1</span>
 <span style="color:teal;">0.888156</span>    <span style="color:teal;">1</span>
 <span style="color:teal;">1.000000</span>    <span style="color:teal;">1</span>
 <span style="color:teal;">1.540274</span>    <span style="color:teal;">1</span>
</code></pre><p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">groupby 的参数还可以是函数</p>
<pre style="font-size:1em;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.75;overflow:auto;position:relative;"><code lang="python" style="border-radius:2px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;background-color:rgb(255, 245, 245);word-break:normal;color:rgb(51, 51, 51);font-size:11px;overflow-x:auto;margin:0px;display:block;background:rgb(248, 248, 248);padding:18px 15px 12px;"><span style="font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:11px;color:rgb(51, 51, 51);position:absolute;right:15px;top:2px;">python</span><span style="color:rgb(153, 153, 136);"># 添加E为时间列，根据时间的年进行分组</span>
In [<span style="color:teal;">255</span>]: df[<span style="color:rgb(221, 17, 68);">'E'</span>] = df.index

In [<span style="color:teal;">256</span>]: df
Out[<span style="color:teal;">256</span>]:
                            A         B         C         D          E
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span> <span style="color:teal;">00</span>:<span style="color:teal;">00</span>:<span style="color:teal;">00</span>  <span style="color:teal;">0.513286</span> <span style="color:teal;">-1.475824</span>  <span style="color:teal;">1.939876</span> <span style="color:teal;">-0.163942</span> <span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-01</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span> <span style="color:teal;">00</span>:<span style="color:teal;">00</span>:<span style="color:teal;">00</span> <span style="color:teal;">-0.518291</span>  <span style="color:teal;">1.345230</span>  <span style="color:teal;">0.510746</span>  <span style="color:teal;">1.284767</span> <span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-02</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span> <span style="color:teal;">00</span>:<span style="color:teal;">00</span>:<span style="color:teal;">00</span> <span style="color:teal;">-0.434865</span> <span style="color:teal;">-0.464227</span>  <span style="color:teal;">1.830259</span> <span style="color:teal;">-0.719290</span> <span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-03</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span> <span style="color:teal;">00</span>:<span style="color:teal;">00</span>:<span style="color:teal;">00</span>  <span style="color:teal;">0.654418</span> <span style="color:teal;">-0.994241</span>  <span style="color:teal;">0.162705</span>  <span style="color:teal;">2.816623</span> <span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-04</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span> <span style="color:teal;">00</span>:<span style="color:teal;">00</span>:<span style="color:teal;">00</span>  <span style="color:teal;">1.540274</span> <span style="color:teal;">-0.227124</span>  <span style="color:teal;">1.843401</span> <span style="color:teal;">-2.977880</span> <span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-05</span>
<span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span> <span style="color:teal;">00</span>:<span style="color:teal;">00</span>:<span style="color:teal;">00</span>  <span style="color:teal;">0.888156</span>  <span style="color:teal;">1.932291</span>  <span style="color:teal;">0.998568</span>  <span style="color:teal;">0.143846</span> <span style="color:teal;">2013</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>
<span style="color:teal;">2014</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span> <span style="color:teal;">00</span>:<span style="color:teal;">00</span>:<span style="color:teal;">00</span>  <span style="color:teal;">1.000000</span>  <span style="color:teal;">1.000000</span>  <span style="color:teal;">1.000000</span>  <span style="color:teal;">1.000000</span> <span style="color:teal;">2014</span><span style="color:teal;">-01</span><span style="color:teal;">-06</span>

In [<span style="color:teal;">257</span>]: df.groupby(<span style="color:rgb(51, 51, 51);font-weight:700;">lambda</span> x : df.E[x].year).size()
Out[<span style="color:teal;">257</span>]:
<span style="color:teal;">2013</span>    <span style="color:teal;">6</span>
<span style="color:teal;">2014</span>    <span style="color:teal;">1</span>
dtype: int64
</code></pre><p style="line-height:inherit;margin-top:22px;margin-bottom:22px;">关于Pandas更多详细的用法可以参考Pandas官方文档<a href="https://link.juejin.im/?target=https%3A%2F%2Fpandas.pydata.org" rel="nofollow noopener noreferrer" style="margin:initial;background-color:transparent;text-decoration:none;cursor:pointer;color:rgb(2, 105, 200);border-bottom:1px solid rgb(209, 233, 255);" target="_blank">pandas.pydata.org</a>，下一节我们将正式进入数据分析环节。</p>
</div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
</span>
</div></body></html> 